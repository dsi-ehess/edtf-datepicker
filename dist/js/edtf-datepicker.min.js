/*!
 * EDTF datepicker for Bootstrap v1.0.0 (https://github.com/dsi-ehess/edtf-datepicker)
 *
 * Licensed under the GNU General Public License v3.0 (https://www.gnu.org/licenses/gpl-3.0.en.html)
 */

!function(e){"function"==typeof define&&define.amd?define(["jquery","edtf"],e):"object"==typeof exports?e(require("jquery"),require("edtf")):e(jQuery,edtf)}(function(V,Y,O){function E(){var e=Y(new Date(Date.UTC.apply(Date,arguments)));return e.precision=3,e}function A(){var e=new Date;return E(e.getFullYear(),e.getMonth(),e.getDate())}function r(e,t){return e.getUTCFullYear()===t.getUTCFullYear()&&e.getUTCMonth()===t.getUTCMonth()&&e.getUTCDate()===t.getUTCDate()}function e(e,t){return function(){return t!==O&&V.fn.datepicker.deprecated(t),this[e].apply(this,arguments)}}function d(e,t){V.data(e,"datepicker",this),this._events=[],this._secondaryEvents=[],this._process_options(t),this.dates=new i,this.viewDate=this.o.defaultViewDate,this.focusDate=null,this.element=V(e),this.isInput=this.element.is("input"),this.inputField=this.isInput?this.element:this.element.find("input"),this.component=!!this.element.hasClass("date")&&this.element.find(".add-on, .input-group-addon, .input-group-append, .input-group-prepend, .btn"),this.component&&0===this.component.length&&(this.component=!1),null===this.o.isInline?this.isInline=!this.component&&!this.isInput:this.isInline=this.o.isInline,this.picker=V(u.template),this._check_template(this.o.templates.leftArrow)&&this.picker.find(".prev").html(this.o.templates.leftArrow),this._check_template(this.o.templates.rightArrow)&&this.picker.find(".next").html(this.o.templates.rightArrow),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu"),this.o.rtl&&this.picker.addClass("datepicker-rtl"),this.o.calendarWeeks&&this.picker.find(".datepicker-days .datepicker-switch, thead .datepicker-title, tfoot .today, tfoot .clear").attr("colspan",function(e,t){return Number(t)+1}),this._process_options({startDate:this._o.startDate,endDate:this._o.endDate,daysOfWeekDisabled:this.o.daysOfWeekDisabled,daysOfWeekHighlighted:this.o.daysOfWeekHighlighted,datesDisabled:this.o.datesDisabled}),this._allow_update=!1,this.setViewMode(this.o.startView),this._allow_update=!0,this.fillDow(),this.fillMonths(),this.update(),this.isInline&&this.show()}var t,i=(t={get:function(e){return this.slice(e)[0]},contains:function(e){for(var t=0,i=this.length;t<i;t++){var a=Y(this[t]);if(a.precision||(a.precision=3),a.edtf===e.edtf)return t}return-1},remove:function(e){this.splice(e,1)},replace:function(e){e&&(V.isArray(e)||(e=[e]),this.clear(),this.push.apply(this,e))},clear:function(){this.length=0},copy:function(){var e=new i;return e.replace(this),e}},function(){var e=[];return e.push.apply(e,arguments),V.extend(e,t),e});d.prototype={constructor:d,_resolveViewName:function(i){return V.each(u.viewModes,function(e,t){if(i===e||-1!==V.inArray(i,t.names))return i=e,!1}),i},_resolveDaysOfWeek:function(e){return V.isArray(e)||(e=e.split(/[,\s]*/)),V.map(e,Number)},_check_template:function(e){try{return e!==O&&""!==e&&((e.match(/[<>]/g)||[]).length<=0||0<V(e).length)}catch(e){return!1}},_process_options:function(e){this._o=V.extend({},this._o,e);var t=this.o=V.extend({},this._o),i=t.language;F[i]||(i=i.split("-")[0],F[i]||(i=c.language)),t.language=i,t.startView=this._resolveViewName(t.startView),t.minViewMode=this._resolveViewName(t.minViewMode),t.maxViewMode=this._resolveViewName(t.maxViewMode),t.startView=Math.max(this.o.minViewMode,Math.min(this.o.maxViewMode,t.startView)),!0!==t.multidate&&(t.multidate=Number(t.multidate)||!1,!1!==t.multidate&&(t.multidate=Math.max(0,t.multidate))),t.multidateSeparator=String(t.multidateSeparator),t.weekStart%=7,t.weekEnd=(t.weekStart+6)%7,t.startDate!==-1/0&&(t.startDate?t.startDate instanceof Date?t.startDate=this._local_to_utc(this._zero_time(t.startDate)):t.startDate=u.parseDate(t.startDate):t.startDate=-1/0),t.endDate!==1/0&&(t.endDate?t.endDate instanceof Date?t.endDate=this._local_to_utc(this._zero_time(t.endDate)):t.endDate=u.parseDate(t.endDate):t.endDate=1/0),t.daysOfWeekDisabled=this._resolveDaysOfWeek(t.daysOfWeekDisabled||[]),t.daysOfWeekHighlighted=this._resolveDaysOfWeek(t.daysOfWeekHighlighted||[]),t.datesDisabled=t.datesDisabled||[],V.isArray(t.datesDisabled)||(t.datesDisabled=t.datesDisabled.split(",")),t.datesDisabled=V.map(t.datesDisabled,function(e){return u.parseDate(e)});var a=String(t.orientation).toLowerCase().split(/\s+/g),s=t.orientation.toLowerCase();if(a=V.grep(a,function(e){return/^auto|left|right|top|bottom$/.test(e)}),t.orientation={x:"auto",y:"auto"},s&&"auto"!==s)if(1===a.length)switch(a[0]){case"top":case"bottom":t.orientation.y=a[0];break;case"left":case"right":t.orientation.x=a[0]}else s=V.grep(a,function(e){return/^left|right$/.test(e)}),t.orientation.x=s[0]||"auto",s=V.grep(a,function(e){return/^top|bottom$/.test(e)}),t.orientation.y=s[0]||"auto";else;if(t.defaultViewDate instanceof Date||"string"==typeof t.defaultViewDate)t.defaultViewDate=u.parseDate(t.defaultViewDate);else if(t.defaultViewDate){var n=t.defaultViewDate.year||(new Date).getFullYear(),r=t.defaultViewDate.month||0,o=t.defaultViewDate.day||1;t.defaultViewDate=E(n,r,o)}else t.defaultViewDate=A()},_applyEvents:function(e){for(var t,i,a,s=0;s<e.length;s++)t=e[s][0],2===e[s].length?(i=O,a=e[s][1]):3===e[s].length&&(i=e[s][1],a=e[s][2]),t.on(a,i)},_unapplyEvents:function(e){for(var t,i,a,s=0;s<e.length;s++)t=e[s][0],2===e[s].length?(a=O,i=e[s][1]):3===e[s].length&&(a=e[s][1],i=e[s][2]),t.off(i,a)},_buildEvents:function(){var e={keyup:V.proxy(function(e){-1===V.inArray(e.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:V.proxy(this.keydown,this),paste:V.proxy(this.paste,this)};!0===this.o.showOnFocus&&(e.focus=V.proxy(this.show,this)),this.isInput?this._events=[[this.element,e]]:this.component&&this.inputField.length?this._events=[[this.inputField,e],[this.component,{click:V.proxy(this.show,this)}]]:this._events=[[this.element,{click:V.proxy(this.show,this),keydown:V.proxy(this.keydown,this)}]],this._events.push([this.element,"*",{blur:V.proxy(function(e){this._focused_from=e.target},this)}],[this.element,{blur:V.proxy(function(e){this._focused_from=e.target},this)}]),this.o.immediateUpdates&&this._events.push([this.element,{"changeMillennium changeCentury changeDecade changeYear changeMonth":V.proxy(function(e){e.date.precision="changeMonth"===e.type?2:1,e.date=Y(e.date.edtf),this.update(e.date)},this)}]),this._secondaryEvents=[[this.picker,{click:V.proxy(this.click,this)}],[this.picker,".prev, .next",{click:V.proxy(this.navArrowsClick,this)}],[this.picker,".day:not(.disabled)",{click:V.proxy(this.dayCellClick,this)}],[V(window),{resize:V.proxy(this.place,this)}],[V(document),{"mousedown touchstart":V.proxy(function(e){this.element.is(e.target)||this.element.find(e.target).length||this.picker.is(e.target)||this.picker.find(e.target).length||this.isInline||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(e,t){var i=t||this.dates.get(-1),a=this._utc_to_local(i);this.element.trigger({type:e,date:a,viewMode:this.viewMode,dates:V.map(this.dates,this._utc_to_local),format:V.proxy(function(e,t){0===arguments.length?e=this.dates.length-1:"string"==typeof e&&(t=e,e=this.dates.length-1);var i=this.dates.get(e);return u.formatDate(i,t,this.o.language)},this)})},show:function(){if(!(this.inputField.is(":disabled")||this.inputField.prop("readonly")&&!1===this.o.enableOnReadonly))return this.isInline||this.picker.appendTo(this.o.container),this.place(),this.picker.show(),this._attachSecondaryEvents(),this._trigger("show"),(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&this.o.disableTouchKeyboard&&V(this.element).blur(),this},hide:function(){return this.isInline||!this.picker.is(":visible")||(this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.setViewMode(this.o.startView),this.o.forceParse&&this.inputField.val()&&this.setValue(),this._trigger("hide")),this},destroy:function(){return this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date,this},paste:function(e){var t;if(e.originalEvent.clipboardData&&e.originalEvent.clipboardData.types&&-1!==V.inArray("text/plain",e.originalEvent.clipboardData.types))t=e.originalEvent.clipboardData.getData("text/plain");else{if(!window.clipboardData)return;t=window.clipboardData.getData("Text")}this.setDate(t),this.update(),e.preventDefault()},_utc_to_local:function(e){if(!e||!(e instanceof Y.Date||e instanceof Date)||e.precision<3)return e;var t=new Date(e.getTime()+6e4*e.getTimezoneOffset());return t.getTimezoneOffset()!==e.getTimezoneOffset()&&(t=new Date(e.getTime()+6e4*t.getTimezoneOffset())),(t=Y(t)).precision=3,t},_local_to_utc:function(e){return!e||!(e instanceof Date||e instanceof Y.Date)||e.precision&&e.precision<3?e:Y(new Date(e.getTime()-6e4*e.getTimezoneOffset()))},_zero_time:function(e){return e&&Y(new Date(e.getFullYear(),e.getMonth(),e.getDate()))},_zero_utc_time:function(e){return e&&E(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())},getDates:function(){return V.map(this.dates,this._utc_to_local)},getUTCDates:function(){return V.map(this.dates,function(e){return new Date(e)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){var e=this.dates.get(-1);return e!==O?new Date(e):null},clearDates:function(){this.inputField.val(""),this._trigger("changeDate"),this.update(),this.o.autoclose&&this.hide()},setDates:function(){var e=V.isArray(arguments[0])?arguments[0]:arguments;return this.update.apply(this,e),this._trigger("changeDate"),this.setValue(),this},setUTCDates:function(){var e=V.isArray(arguments[0])?arguments[0]:arguments;return this.setDates.apply(this,V.map(e,this._utc_to_local)),this},setDate:e("setDates"),setUTCDate:e("setUTCDates"),remove:e("destroy","Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead"),setValue:function(){var e=this.getFormattedDate();return this.inputField.val(e),this},getFormattedDate:function(){return V.map(this.dates,function(e){var t=Y(e);return t.precision||(t.precision=3),t.edtf}).join(this.o.multidateSeparator)},getStartDate:function(){return this.o.startDate},setStartDate:function(e){return this._process_options({startDate:e}),this.update(),this.updateNavArrows(),this},getEndDate:function(){return this.o.endDate},setEndDate:function(e){return this._process_options({endDate:e}),this.update(),this.updateNavArrows(),this},setDaysOfWeekDisabled:function(e){return this._process_options({daysOfWeekDisabled:e}),this.update(),this},setDaysOfWeekHighlighted:function(e){return this._process_options({daysOfWeekHighlighted:e}),this.update(),this},setDatesDisabled:function(e){return this._process_options({datesDisabled:e}),this.update(),this},place:function(){if(this.isInline)return this;var e=this.picker.outerWidth(),t=this.picker.outerHeight(),i=V(this.o.container),a=i.width(),s="body"===this.o.container?V(document).scrollTop():i.scrollTop(),n=i.offset(),r=[0];this.element.parents().each(function(){var e=V(this).css("z-index");"auto"!==e&&0!==Number(e)&&r.push(Number(e))});var o=Math.max.apply(Math,r)+this.o.zIndexOffset,h=this.component?this.component.parent().offset():this.element.offset(),d=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),l=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),c=h.left-n.left,p=h.top-n.top;"body"!==this.o.container&&(p+=s),this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left"),"auto"!==this.o.orientation.x?(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(c-=e-l)):h.left<0?(this.picker.addClass("datepicker-orient-left"),c-=h.left-10):a<c+e?(this.picker.addClass("datepicker-orient-right"),c+=l-e):this.o.rtl?this.picker.addClass("datepicker-orient-right"):this.picker.addClass("datepicker-orient-left");var u=this.o.orientation.y;if("auto"===u&&(u=-s+p-t<0?"bottom":"top"),this.picker.addClass("datepicker-orient-"+u),"top"===u?p-=t+parseInt(this.picker.css("padding-top")):p+=d,this.o.rtl){var f=a-(c+l);this.picker.css({top:p,right:f,zIndex:o})}else this.picker.css({top:p,left:c,zIndex:o});return this},_allow_update:!0,update:function(){if(!this._allow_update)return this;var e=this.dates.copy(),a=[],t=!1;return arguments.length?(V.each(arguments,V.proxy(function(e,t){if(t instanceof Date||t instanceof Y.Date){var i=t.precision;(t=this._local_to_utc(t)).precision=i}a.push(t)},this)),t=!0):(a=(a=this.isInput?this.element.val():this.element.data("date")||this.inputField.val())&&this.o.multidate?a.split(this.o.multidateSeparator):[a],delete this.element.data().date),a=V.map(a,V.proxy(function(e){return u.parseDate(e)},this)),a=V.grep(a,V.proxy(function(e){return!this.dateWithinRange(e)||!e},this),!0),this.dates.replace(a),this.o.updateViewDate&&(this.dates.length?this.viewDate=Y(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=Y(this.o.startDate):this.viewDate>this.o.endDate?this.viewDate=Y(this.o.endDate):this.viewDate=this.o.defaultViewDate),t?(this.setValue(),this.element.change()):this.dates.length&&String(e)!==String(this.dates)&&t&&(this._trigger("changeDate"),this.element.change()),!this.dates.length&&e.length&&(this._trigger("clearDate"),this.element.change()),this.fill(),this},fillDow:function(){if(this.o.showWeekDays){var e=this.o.weekStart,t='<tr class="dow-header">';for(this.o.calendarWeeks&&(t+='<th class="cw">&#160;</th>');e<this.o.weekStart+7;)t+='<th class="dow',-1!==V.inArray(e,this.o.daysOfWeekDisabled)&&(t+=" disabled"),t+='">'+F[this.o.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".datepicker-days thead").append(t)}},fillMonths:function(){for(var e=this.viewDate,t="",i=0;i<12;i++)t+='<span class="month'+(e&&!this.viewDate.unspecified.is("month")&&1<e.precision&&e.month===i?" focused":"")+'">'+F[this.o.language].monthsShort[i]+"</span>";this.picker.find(".datepicker-months td").html(t)},setRange:function(e){e&&e.length?this.range=V.map(e,function(e){return e.valueOf()}):delete this.range,this.fill()},getClassNames:function(e){var t=[],i=this.viewDate.year,a=this.viewDate.month,s=A(),n=Y(this.focusDate||new Date);return n.approximate.value=0,n.uncertain.value=0,e.year<i||e.year===i&&e.month<a?t.push("old"):(e.year>i||e.year===i&&e.month>a)&&t.push("new"),this.focusDate&&e.edtf===n.edtf&&t.push("focused"),this.o.todayHighlight&&r(e,s)&&t.push("today"),-1!==this.dates.contains(e)&&t.push("active"),(!this.dateWithinRange(e)||9999<e.year||e.year<-9999)&&t.push("disabled"),this.dateIsDisabled(e)&&t.push("disabled","disabled-date"),-1!==V.inArray(e.getUTCDay(),this.o.daysOfWeekHighlighted)&&t.push("highlighted"),this.range&&(e>this.range[0]&&e<this.range[this.range.length-1]&&t.push("range"),-1!==V.inArray(e.valueOf(),this.range)&&t.push("selected"),e.valueOf()===this.range[0]&&t.push("range-start"),e.valueOf()===this.range[this.range.length-1]&&t.push("range-end")),t},_fill_status_table:function(e,t){var i="";if(!(t instanceof Y.Year)){switch(i="<table><thead><tr><th></th><th>"+(F[this.o.language].approximate||"Approximate")+"</th><th>"+(F[this.o.language].uncertain||"Uncertain")+"</th></tr></thead><tbody>",t.precision){case 3:i+="<tr><td>"+(F[this.o.language].day||"Day")+'</td><td><input type="checkbox" class="dateStatus" name="approximate" value="day" '+(t.approximate.is("day")?"checked":"")+'/></td><td><input type="checkbox" class="dateStatus" name="uncertain" value="day" '+(t.uncertain.is("day")?"checked":"")+"/></td></tr>";case 2:i+="<tr><td>"+(F[this.o.language].month||"Month")+'</td><td><input type="checkbox" class="dateStatus" name="approximate" value="month" '+(t.approximate.is("month")?"checked":"")+'/></td><td><input type="checkbox" class="dateStatus" name="uncertain" value="month" '+(t.uncertain.is("month")?"checked":"")+"/></td></tr>";default:i+="<tr><td>"+(F[this.o.language].year||"Year")+'</td><td><input type="checkbox" class="dateStatus" name="approximate" value="year" '+(t.approximate.is("year")?"checked":"")+'/></td><td><input type="checkbox" class="dateStatus" name="uncertain" value="year" '+(t.uncertain.is("year")?"checked":"")+"/></td></tr>"}i+="</tbody></table>"}this.picker.find(e+" tfoot .statuses").html(i)},_fill_unspecified_cells:function(e,t){var i="",a=Y(t.edtf);if(!(t instanceof Y.Year))switch(e){case".datepicker-centuries":a.precision=1,a.unspecified.value=Y.Bitmask.Y-1,i='<th colspan="7"><span class="year unspecified '+(-1!==this.dates.contains(a)?"active":"")+'">'+a.edtf+"</span></th>";break;case".datepicker-decades":a.precision=1,a.unspecified.value=Y.Bitmask.YYXX,i='<th colspan="7"><span class="year unspecified '+(-1!==this.dates.contains(a)?"active":"")+'">'+a.edtf+"</span></th>";break;case".datepicker-years":a.precision=1,a.unspecified.value=Y.Bitmask.YYYX,i='<th colspan="7"><span class="year unspecified '+(-1!==this.dates.contains(a)?"active":"")+'">'+a.edtf+"</span></th>";break;case".datepicker-months":i='<th colspan="7"><span class="month unspecified">XX</span><span class="month unspecified">0X</span><span class="month unspecified">1X</span></th>';break;default:a.approximate.value=0,a.uncertain.value=0,a.precision=2,i='<th colspan="7"><span class="day unspecified" data-date="'+a.edtf+'-XX">XX</span><span class="day unspecified" data-date="'+a.edtf+'-0X">0X</span><span class="day unspecified" data-date="'+a.edtf+'-1X">1X</span><span class="day unspecified" data-date="'+a.edtf+'-2X">2X</span>'+(1!==a.month?'<span class="day unspecified" data-date="'+a.edtf+'-3X">3X</span>':"")+"</th>"}this.picker.find(e+" tfoot .unspecified-cells").html(i)},_fill_yearsView:function(e,t,i,a,s,n,r){for(var o,h,d,l="",c=i/10,p=this.picker.find(e),u=Math.floor(a/i)*i,f=u+9*c,g=Math.floor(this.viewDate.year/c)*c,v=V.map(this.dates,function(e){return e.significant||e instanceof Y.Date&&e.unspecified.is("year")?null:Math.floor(e.year/c)*c}),D=u-c;D<=f+c;D+=c){o=[t],h=null,D===u-c?o.push("old"):D===f+c&&o.push("new"),-1!==V.inArray(D,v)&&o.push("active"),(D<s||n<D)&&o.push("disabled"),D===g&&o.push("focused"),r!==V.noop&&((d=r(new Date(D,0,1)))===O?d={}:"boolean"==typeof d?d={enabled:d}:"string"==typeof d&&(d={classes:d}),!1===d.enabled&&o.push("disabled"),d.classes&&(o=o.concat(d.classes.split(/\s+/))),d.tooltip&&(h=d.tooltip));var m=D;switch(i){case 1e3:m=D.toString().slice(0,-2)+"XX";break;case 100:m=D.toString().slice(0,-1)+"X"}l+='<span class="'+o.join(" ")+'"'+(h?' title="'+h+'"':"")+">"+m+"</span>"}p.find("td").html(l)},fill:function(){var e,t,i=Y(this.viewDate),a=Y(this.viewDate),s=i.year,n=i instanceof Y.Year?0:i.month,r=this.o.startDate!==-1/0?this.o.startDate.getUTCFullYear():-1/0,o=this.o.startDate!==-1/0?this.o.startDate.getUTCMonth():-1/0,h=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,d=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0,l=F[this.o.language].today||F.en.today||"",c=F[this.o.language].clear||F.en.clear||"",p=(F[this.o.language].titleFormat||F.en.titleFormat,A()),u=(!0===this.o.todayBtn||"linked"===this.o.todayBtn)&&p>=this.o.startDate&&p<=this.o.endDate&&!this.weekOfDateIsDisabled(p),f=!1;if(!isNaN(s)&&!isNaN(n)){if(i instanceof Y.Date&&(f=!i.unspecified.month&&!i.unspecified.year,a.precision=1===a.precision?1:2),this.picker.find(".datepicker-switch").text(a.edtf),this.picker.find("tfoot .today").text(l).css("display",u?"table-cell":"none"),this.picker.find("tfoot .clear").text(c).css("display",!0===this.o.clearBtn?"table-cell":"none"),this.picker.find("thead .datepicker-title").text(this.o.title).css("display","string"==typeof this.o.title&&""!==this.o.title?"table-cell":"none"),this.updateNavArrows(),!(i instanceof Y.Year)){this.fillMonths(),this.toggleDowHeader(f);var g=E(s,n,0),v=g.getUTCDate();g.approximate.value=i.approximate.value,g.uncertain.value=i.uncertain.value,g.setUTCDate(v-(g.getUTCDay()-this.o.weekStart+7)%7);var D=new Y.Date(g);g.getUTCFullYear()<100&&D.setUTCFullYear(g.getUTCFullYear()),D.setUTCDate(D.getUTCDate()+42),D=D.valueOf();var m,y,w=[];if(f)for(;g.valueOf()<D;){if((m=g.getUTCDay())===this.o.weekStart&&(w.push("<tr>"),this.o.calendarWeeks)){var k=new Date(+g+(this.o.weekStart-m-7)%7*864e5),_=new Date(Number(k)+(11-k.getUTCDay())%7*864e5),b=new Date(Number(b=E(_.getUTCFullYear(),0,1))+(11-b.getUTCDay())%7*864e5),C=(_-b)/864e5/7+1;w.push('<td class="cw">'+C+"</td>")}g.precision=3,(y=this.getClassNames(g)).push("day");var M=g.getUTCDate();this.o.beforeShowDay!==V.noop&&((t=this.o.beforeShowDay(this._utc_to_local(g)))===O?t={}:"boolean"==typeof t?t={enabled:t}:"string"==typeof t&&(t={classes:t}),!1===t.enabled&&y.push("disabled"),t.classes&&(y=y.concat(t.classes.split(/\s+/))),t.tooltip&&(e=t.tooltip),t.content&&(M=t.content)),y=V.isFunction(V.uniqueSort)?V.uniqueSort(y):V.unique(y),w.push('<td class="'+y.join(" ")+'"'+(e?' title="'+e+'"':"")+' data-date="'+Y(g).edtf+'">'+M+"</td>"),e=null,m===this.o.weekEnd&&w.push("</tr>"),g.setUTCDate(g.getUTCDate()+1)}else{var T=Y(i);T.precision=2;for(var x=0;x<(1===n?29:31);x++)x%7==0&&w.push("<tr>"),w.push('<td class="day"'+(e?' title="'+e+'"':"")+' data-date="'+T.edtf+"-"+("00"+(x+1)).slice(-2)+'">'+(x+1)+"</td>"),e=null,x%7==6&&w.push("</tr>")}this.picker.find(".datepicker-days tbody:first").html(w.join(""));var U=this.picker.find(".datepicker-months").find("tbody span").removeClass("active");if(V.each(this.dates,function(e,t){t.year===s&&1<t.precision&&!t.unspecified.is("month")&&U.eq(t.month).addClass("active")}),(s<r||h<s)&&U.addClass("disabled"),s===r&&U.slice(0,o).addClass("disabled"),s===h&&U.slice(d+1).addClass("disabled"),this.o.beforeShowMonth!==V.noop){var S=this;V.each(U,function(e,t){var i=new Date(s,e,1),a=S.o.beforeShowMonth(i);a===O?a={}:"boolean"==typeof a?a={enabled:a}:"string"==typeof a&&(a={classes:a}),!1!==a.enabled||V(t).hasClass("disabled")||V(t).addClass("disabled"),a.classes&&V(t).addClass(a.classes),a.tooltip&&V(t).prop("title",a.tooltip)})}}this._fill_yearsView(".datepicker-years","year",10,s,r,h,this.o.beforeShowYear),i instanceof Y.Date&&!i.unspecified.value?(this._fill_status_table(".datepicker-days",i),this._fill_status_table(".datepicker-months",i),this._fill_status_table(".datepicker-years",i)):this.picker.find("tfoot .statuses").html(""),this._fill_yearsView(".datepicker-decades","decade",100,s,r,h,this.o.beforeShowDecade),this._fill_yearsView(".datepicker-centuries","century",1e3,s,r,h,this.o.beforeShowCentury),this._fill_unspecified_cells(".datepicker-days",i),this._fill_unspecified_cells(".datepicker-months",i),this._fill_unspecified_cells(".datepicker-years",i),this._fill_unspecified_cells(".datepicker-decades",i),this._fill_unspecified_cells(".datepicker-centuries",i)}},updateNavArrows:function(){if(this._allow_update){var e,t,i=this.viewDate,a=i.year,s=i.month,n=this.o.startDate!==-1/0?this.o.startDate.getUTCFullYear():-1/0,r=this.o.startDate!==-1/0?this.o.startDate.getUTCMonth():-1/0,o=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,h=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0,d=i instanceof Y.Date&&(i.unspecified.is("year")||i.unspecified.is("month")),l=1;switch(this.viewMode){case 4:l*=10;case 3:l*=10;case 2:l*=10;case 1:e=Math.floor(a/l)*l<=n,t=Math.floor(a/l)*l+l>o;break;case 0:e=a<=n&&s<=r||d,t=o<=a&&h<=s||d}this.picker.find(".prev").toggleClass("disabled",e),this.picker.find(".next").toggleClass("disabled",t)}},click:function(e){var t,i,a;if(e.preventDefault(),e.stopPropagation(),(t=V(e.target)).hasClass("datepicker-switch")&&this.viewMode!==this.o.maxViewMode){if(this.viewDate instanceof Y.Year)this.viewDate.significant=(this.viewDate.significant||0)+1;else switch(this.viewMode){case 3:this.viewDate.unspecified.value-=this.viewDate.unspecified.is("year"),this.viewDate.unspecified.add(Y.Bitmask.Y-1);break;case 2:this.viewDate.unspecified.value-=this.viewDate.unspecified.is("year"),this.viewDate.unspecified.add(Y.Bitmask.YYXX);break;case 1:this.viewDate.unspecified.value-=this.viewDate.unspecified.is("year"),this.viewDate.unspecified.add(Y.Bitmask.YYYX);break;default:this.viewDate.precision=1}this._setDate(this.viewDate),1!==this.viewDate.significant&&this.setViewMode(this.viewMode+1)}if(t.hasClass("today")&&!t.hasClass("day")&&(this.setViewMode(0),this._setDate(A(),"linked"===this.o.todayBtn?null:"view")),t.hasClass("clear")&&this.clearDates(),t.hasClass("dateStatus")){var s=this.dates.get(-1)||this.viewDate,n=t.attr("name"),r=t.attr("value");s[n].is(r)?s[n]=s[n].value-s[n][r]:s[n].add(r),this._setDate(s),this.fill()}if(!t.hasClass("disabled")&&(t.hasClass("month")||t.hasClass("year")||t.hasClass("decade")||t.hasClass("century"))){if(this.viewDate instanceof Y.Year||this.viewDate.setUTCDate(1),1,!t.hasClass("active")||t.hasClass("century")||t.hasClass("decade")||this.viewDate.significant||this.viewDate.unspecified&&this.viewDate.unspecified.value){if(1===this.viewMode)this.viewDate.unspecified.value-=this.viewDate.unspecified.month,t.hasClass("unspecified")?(a="1X"===t.text()?9:0,this.viewDate.unspecified.add("XX"===t.text()?Y.Bitmask.M:Y.Bitmask.MX)):a=t.parent().find("span").index(t),i=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(a),this.viewDate.precision=2;else{a=0;var o=t.text(),h="";if(0===o.indexOf("-")&&(h="-",o=o.substr("1")),4<o.length){var d=(o.match(/X/g)||[]).length;this.viewDate=Y("Y"+h+o.replace(/X/g,"0")+(d?"S"+d:""))}else this.viewDate=Y(h+("0000"+o).slice(-4))}t.hasClass("year")&&(this.viewMode=2),this._trigger(u.viewModes[this.viewMode-1].e,this.viewDate)}this.viewMode===this.o.minViewMode?this._setDate(E(i,a,1)):(this.viewDate instanceof Y.Year&&!(2<this.viewMode)||this.setViewMode(this.viewMode-1),this.fill())}this.picker.is(":visible")&&this._focused_from&&this._focused_from.focus(),delete this._focused_from},dayCellClick:function(e){var t=V(e.currentTarget).data("date"),i=Y(t);if(this.o.updateViewDate){var a=Y(this.viewDate);i.year!==a.year&&this._trigger("changeYear",a),i.month!==a.month&&this._trigger("changeMonth",a)}this._setDate(i)},navArrowsClick:function(e){var t=V(e.currentTarget).hasClass("prev")?-1:1;if(0!==this.viewMode){var i=1;if(1===this.viewMode)switch(this.viewDate.unspecified.year){case Y.Bitmask.YYYX:i=10;break;case Y.Bitmask.YYYX:i=100;break;case Y.Bitmask.Y-1:i=1e3}t*=12*u.viewModes[this.viewMode].navStep*i}var a=this.moveMonth(this.viewDate,t);switch(this.viewMode){case 2:a.unspecified.value=Y.Bitmask.YYYX;break;case 3:a.unspecified.value=Y.Bitmask.YYXX;break;case 4:a.unspecified.value=Y.Bitmask.Y-1;break;default:a.unspecified.value=this.viewDate.unspecified.value}(9999<a.year||a.year<-9999)&&(a=Y("Y"+a.year+(this.viewMode-1?"S"+(this.viewMode-1):""))),this.viewDate=a,this._trigger(u.viewModes[this.viewMode].e,this.viewDate),this.fill()},_toggle_multidate:function(e){var t=this.dates.contains(e);if(e||this.dates.clear(),-1!==t?(!0===this.o.multidate||1<this.o.multidate||this.o.toggleActive)&&this.dates.remove(t):(!1===this.o.multidate&&this.dates.clear(),this.dates.push(e)),"number"==typeof this.o.multidate)for(;this.dates.length>this.o.multidate;)this.dates.remove(0)},_setDate:function(e,t){t&&"date"!==t||this._toggle_multidate(e&&Y(e)),(!t&&this.o.updateViewDate||"view"===t)&&(this.viewDate=e&&Y(e)),this.fill(),this.setValue(),t&&"view"===t||this._trigger("changeDate"),this.inputField.trigger("change"),!this.o.autoclose||t&&"date"!==t||this.hide()},moveDay:function(e,t){return e.next(t)},moveWeek:function(e,t){return this.moveDay(e,7*t)},moveMonth:function(e,t){if(!(e instanceof Y.Year||function(e){return e&&!isNaN(e.getTime())}(e)))return this.o.defaultViewDate;if(!t)return e;var i,a,s=new Date(e.valueOf()),n=s.getUTCDate(),r=s.getUTCMonth(),o=Math.abs(t);if(t=0<t?1:-1,1===o)a=-1===t?function(){return s.getUTCMonth()===r}:function(){return s.getUTCMonth()!==i},i=r+t,s.setUTCMonth(i),i=(i+12)%12;else{for(var h=0;h<o;h++)s=this.moveMonth(s,t);i=s.getUTCMonth(),s.setUTCDate(n),a=function(){return i!==s.getUTCMonth()}}for(;a();)s.setUTCDate(--n),s.setUTCMonth(i);return Y(s)},moveYear:function(e,t){return this.moveMonth(e,12*t)},moveAvailableDate:function(e,t,i){do{if(e=this[i](e,t),!this.dateWithinRange(e))return!1;i="moveDay"}while(this.dateIsDisabled(e));return e},weekOfDateIsDisabled:function(e){return-1!==V.inArray(e.getUTCDay(),this.o.daysOfWeekDisabled)},dateIsDisabled:function(t){return this.weekOfDateIsDisabled(t)||0<V.grep(this.o.datesDisabled,function(e){return r(t,e)}).length},dateWithinRange:function(e){return e>=this.o.startDate&&e<=this.o.endDate},keydown:function(e){if(this.picker.is(":visible")){var t=!1,i=this.focusDate||this.viewDate;switch(e.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide(),e.preventDefault(),e.stopPropagation();break;case 13:if(!this.o.forceParse)break;i=this.focusDate||this.dates.get(-1)||this.viewDate,this.o.keyboardNavigation&&(this._toggle_multidate(i),t=!0),this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.setValue(),this.fill(),this.picker.is(":visible")&&(e.preventDefault(),e.stopPropagation(),this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}t&&(this.dates.length?this._trigger("changeDate"):this._trigger("clearDate"),this.inputField.trigger("change"))}else 40!==e.keyCode&&27!==e.keyCode||(this.show(),e.stopPropagation())},setViewMode:function(e){this.viewMode=e,this.picker.children("div").hide().filter(".datepicker-"+u.viewModes[this.viewMode].clsName).show(),this.updateNavArrows(),this._trigger("changeViewMode",new Date(this.viewDate))},toggleDowHeader:function(e){var t=this.picker.find(".dow-header");return e?t.show():t.hide()}};function l(e,t){V.data(e,"datepicker",this),this.element=V(e),this.inputs=V.map(t.inputs,function(e){return e.jquery?e[0]:e}),delete t.inputs,this.keepEmptyValues=t.keepEmptyValues,delete t.keepEmptyValues,s.call(V(this.inputs),t).on("changeDate",V.proxy(this.dateUpdated,this)),this.pickers=V.map(this.inputs,function(e){return V.data(e,"datepicker")}),this.updateDates()}l.prototype={updateDates:function(){this.dates=V.map(this.pickers,function(e){return e.getUTCDate()}),this.updateRanges()},updateRanges:function(){var i=V.map(this.dates,function(e){return e.valueOf()});V.each(this.pickers,function(e,t){t.setRange(i)})},clearDates:function(){V.each(this.pickers,function(e,t){t.clearDates()})},dateUpdated:function(e){if(!this.updating){this.updating=!0;var i=V.data(e.target,"datepicker");if(i!==O){var a=i.getUTCDate(),s=this.keepEmptyValues,t=V.inArray(e.target,this.inputs),n=t-1,r=t+1,o=this.inputs.length;if(-1!==t){if(V.each(this.pickers,function(e,t){t.getUTCDate()||t!==i&&s||t.setUTCDate(a)}),a<this.dates[n])for(;0<=n&&a<this.dates[n]&&0<(this.pickers[n].element.val()||"").length;)this.pickers[n--].setUTCDate(a);else if(a>this.dates[r])for(;r<o&&a>this.dates[r]&&0<(this.pickers[r].element.val()||"").length;)this.pickers[r++].setUTCDate(a);this.updateDates(),delete this.updating}}}},destroy:function(){V.map(this.pickers,function(e){e.destroy()}),V(this.inputs).off("changeDate",this.dateUpdated),delete this.element.data().datepicker},remove:e("destroy","Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead")};var a=V.fn.datepicker,s=function(r){var o,h=Array.apply(null,arguments);if(h.shift(),this.each(function(){var e=V(this),t=e.data("datepicker"),i="object"==typeof r&&r;if(!t){var a=function(e,t){var i=V(e).data(),a={},s=new RegExp("^"+t.toLowerCase()+"([A-Z])");function n(e,t){return t.toLowerCase()}for(var r in t=new RegExp("^"+t.toLowerCase()),i)t.test(r)&&(a[r.replace(s,n)]=i[r]);return a}(this,"date"),s=function(e){var i={};if(F[e]||(e=e.split("-")[0],F[e])){var a=F[e];return V.each(p,function(e,t){t in a&&(i[t]=a[t])}),i}}(V.extend({},c,a,i).language),n=V.extend({},c,s,a,i);t=e.hasClass("input-daterange")||n.inputs?(V.extend(n,{inputs:n.inputs||e.find("input").toArray()}),new l(this,n)):new d(this,n),e.data("datepicker",t)}"string"==typeof r&&"function"==typeof t[r]&&(o=t[r].apply(t,h))}),o===O||o instanceof d||o instanceof l)return this;if(1<this.length)throw new Error("Using only allowed for the collection of a single element ("+r+" function)");return o};V.fn.datepicker=s;var c=V.fn.datepicker.defaults={assumeNearbyYear:!1,autoclose:!1,beforeShowDay:V.noop,beforeShowMonth:V.noop,beforeShowYear:V.noop,beforeShowDecade:V.noop,beforeShowCentury:V.noop,calendarWeeks:!1,clearBtn:!1,toggleActive:!1,daysOfWeekDisabled:[],daysOfWeekHighlighted:[],datesDisabled:[],endDate:1/0,forceParse:!0,isInline:null,keepEmptyValues:!1,keyboardNavigation:!0,language:"en",minViewMode:0,maxViewMode:4,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-1/0,startView:0,todayBtn:!1,todayHighlight:!1,updateViewDate:!0,weekStart:0,disableTouchKeyboard:!1,enableOnReadonly:!0,showOnFocus:!0,zIndexOffset:10,container:"body",immediateUpdates:!0,title:"",templates:{leftArrow:"&#x00AB;",rightArrow:"&#x00BB;"},showWeekDays:!0},p=V.fn.datepicker.locale_opts=["format","rtl","weekStart"];V.fn.datepicker.Constructor=d;var F=V.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear",titleFormat:"MM yyyy",approximate:"Approximate",uncertain:"Uncertain",day:"Day",month:"Month",year:"Year"}},u={viewModes:[{names:["days","month"],clsName:"days",e:"changeMonth"},{names:["months","year"],clsName:"months",e:"changeYear",navStep:1},{names:["years","decade"],clsName:"years",e:"changeDecade",navStep:10},{names:["decades","century"],clsName:"decades",e:"changeCentury",navStep:100},{names:["centuries","millennium"],clsName:"centuries",e:"changeMillennium",navStep:1e3}],validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\u5e74\u6708\u65e5\[-`{-~\t\n\r]+/g,parseFormat:function(e){if("function"==typeof e.toValue&&"function"==typeof e.toDisplay)return e;var t=e.replace(this.validParts,"\0").split("\0"),i=e.match(this.validParts);if(!t||!t.length||!i||0===i.length)throw new Error("Invalid date format.");return{separators:t,parts:i}},parseDate:function(e){if(!e)return O;if(e instanceof Y.Date)return e;try{return Y(e)}catch(e){if(e.message.startsWith("edtf: No possible parsings (@EOS)"))return O;throw e}},formatDate:function(e,t,i){if(!e)return"";if("string"==typeof t&&(t=u.parseFormat(t)),!t)return e.edtf;if(t.toDisplay)return t.toDisplay(e,t,i);var a={d:e.getUTCDate(),D:F[i].daysShort[e.getUTCDay()],DD:F[i].days[e.getUTCDay()],m:e.getUTCMonth()+1,M:F[i].monthsShort[e.getUTCMonth()],MM:F[i].months[e.getUTCMonth()],yy:e.getUTCFullYear().toString().substring(2),yyyy:e.getUTCFullYear()};a.dd=(a.d<10?"0":"")+a.d,a.mm=(a.m<10?"0":"")+a.m,e=[];for(var s=V.extend([],t.separators),n=0,r=t.parts.length;n<=r;n++)s.length&&e.push(s.shift()),e.push(a[t.parts[n]]);return e.join("")},headTemplate:'<thead><tr><th colspan="7" class="datepicker-title"></th></tr><tr><th class="prev">'+c.templates.leftArrow+'</th><th colspan="5" class="datepicker-switch"></th><th class="next">'+c.templates.rightArrow+"</th></tr></thead>",contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr class="unspecified-cells"></tr><tr><th colspan="7" class="statuses"></th></tr><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};u.template='<div class="datepicker"><div class="datepicker-days"><table class="table-condensed">'+u.headTemplate+"<tbody></tbody>"+u.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+u.headTemplate+u.contTemplate+u.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+u.headTemplate+u.contTemplate+u.footTemplate+'</table></div><div class="datepicker-decades"><table class="table-condensed">'+u.headTemplate+u.contTemplate+u.footTemplate+'</table></div><div class="datepicker-centuries"><table class="table-condensed">'+u.headTemplate+u.contTemplate+u.footTemplate+"</table></div></div>",V.fn.datepicker.DPGlobal=u,V.fn.datepicker.noConflict=function(){return V.fn.datepicker=a,this},V.fn.datepicker.version="1.0.0",V.fn.datepicker.deprecated=function(e){var t=window.console;t&&t.warn&&t.warn("DEPRECATED: "+e)},V(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(e){var t=V(this);t.data("datepicker")||(e.preventDefault(),s.call(t,"show"))}),V(function(){s.call(V('[data-provide="datepicker-inline"]'))})});